{% extends "base_generic.html" %}
{% load widget_tweaks %}

{% block title %}
  <title>Finance Dashboard | Headlights</title>
{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col">
      <h1 class="h3 mb-0 text-gray-800">
        <i class="bi bi-speedometer2 me-2"></i>Finance Dashboard
      </h1>
      <p class="text-muted">Manage companies and generate invoices</p>
    </div>
    <div class="col-auto">
      <div class="card border-0 mb-0">
        <div class="card-body py-2">
          <div class="row align-items-center">
            <div class="col-auto">
              <i class="bi bi-file-text display-6 text-primary"></i>
            </div>
            <div class="col">
              <div class="small text-muted">Total Companies</div>
              <div class="fs-4 fw-bold">{{ num_companies }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

    {% if is_company_owner %}
    <!-- Manage employees button -->
    <div class="mb-3">
        <a class="btn btn-primary btn-lg w-100" href="{% url 'company_manage_employees' %}">
          <i class="bi bi-file-earmark-spreadsheet me-2"></i>Manage Company Users
        </a>
    </div>
    <!-- Edit company button -->
    <div class="mb-3">
        <a class="btn btn-primary btn-lg w-100" href="{% url 'company_details' %}">
          <i class="bi bi-file-earmark-spreadsheet me-2"></i>Company Details
        </a>
    </div>
    {% endif %}

    <!-- Invoice generator form  -->
    <div class="mt-4 p-3 rounded border">
        <div class="card shadow-sm mb-2">
          <div class="card-header bg-light">
            <strong>Invoice Generator</strong>
          </div>
          <div class="card-body">
            <form method="post">
              {% csrf_token %}

              <div class="mb-3">
                <label for="{{ invoice_form.company.id_for_label }}" class="form-label">Company To Invoice</label>
                {{ invoice_form.company|add_class:"form-select" }}
                {% if invoice_form.company.errors %}
                  <div class="text-danger small">{{ invoice_form.company.errors }}</div>
                {% endif %}
              </div>

              <div class="row">
                <div class="col-md-6 mb-3">
                  <label for="{{ invoice_form.month.id_for_label }}" class="form-label">Month</label>
                  {{ invoice_form.month|add_class:"form-select" }}
                  {% if invoice_form.month.errors %}
                    <div class="text-danger small">{{ invoice_form.month.errors }}</div>
                  {% endif %}
                </div>

                <div class="col-md-6 mb-3">
                  <label for="{{ invoice_form.year.id_for_label }}" class="form-label">Year</label>
                  {{ invoice_form.year|add_class:"form-select" }}
                  {% if invoice_form.year.errors %}
                    <div class="text-danger small">{{ invoice_form.year.errors }}</div>
                  {% endif %}
                </div>
              </div>

              <div class="text-center mt-4">
                <button type="submit" class="btn btn-success px-4">Submit</button>
              </div>
            </form>
          </div>
        </div>
      </div>
      
{% endblock %}
